---
title: 17.5: 系统管理-ps
date: 2014年12月26日	 19:5:00
---
 
命令：ps
作用：查看系统进程 
语法：
* "ps -u username" 查看特定用户的所有进程
* "ps aux" 查看完整的系统运行的进程，a列出所有，u按用户分类，x列出进程相关控制台与终端
* "ps -elf" 以长格式查看系统进程信息，e列出所有，l以长格式显示，f全格式显示
 
ps aux列标题含义：
* "PID" process id，进程唯一标识可用于终止进程， kill -9 pid
* "STAT" 表示进程的状态
* D 不能中断的进程（通常为IO）
* R running正在运行的进程
* S stoped已经中断的进程
* T 已经停止或者暂停的进程，如果我们正在运行一个命令，比如说 sleep 10 如果我们按一下ctrl -z 让他暂停，那么我们用ps查看就会显示T这个状态
* X 已经死掉的进程（这个从来不会出现）
* Z 僵尸进程，杀不掉的垃圾进程，占系统一小点资源，不过没有关系。如果太多，就有问题了。
* < 高优先级进程
* N 低优先级进程
* L 在内存中被锁了内存分页
* s 主进程
* l 多线程进程
* + 在前台的进程
 
 
命令：pgrep
作用：根据名称或其他属性查看进程pid
语法：pgrep 参数 pattern
参数：
"-d 间隔符" - 进程号间隔符，默认是换行符 
"-f" - 默认pattern匹配进程名称，加上-f匹配整个命令行
"-U 用户名称/uid" - 指定某个用户执行的进程
"-G 组名/gid" - 指定某个组执行的进程
"-o" - 只匹配存在时间最久的进程
 
用法举例：
## mysql有两个实例，每个实例两个进程，分别为root和mysql执行
# ps aux|grep mysql|grep -v grep|awk '{print $1"-"$2}'
root-9858
mysql-9973
root-9981
mysql-10096
 
## pgrep使用进程名称查找进程号，注意必须使用进程名称mysqld
# pgrep mysqld
9858
9973
9981
10096
 
## -d指定间隔符
# pgrep -d "-" mysqld
9858-9973-9981-10096
 
## -f用来在执行命令全局中查找关键字
# pgrep -f my
9858
9973
9981
10096
# pgrep -f 330
9858
9973
9981
10096
 
## -f和-U搭配找出3306端口号实例的root/mysql执行的进程
# pgrep -f 3306 -U root
9858
# pgrep -f 3306 -U mysql
9973
 
PS:特别需要注意
##有时候你执行的脚本有可能被上面的-f参数模糊匹配到
## 例如我在做一个mysql的启动脚本时，脚本名称是mysqld，
## 当我在这个脚本中匹配mysql的运行实例，并杀死它时，经常脚本会莫名奇妙的中止
## 后来才发现原来是-f匹配mysql实例时把mysqld脚本自身也匹配到了
 
## 解决办法就是使用"-o"参数，匹配最老的一个 
 
命令：pidof
作用：查看正在运行的程序或脚本的pid
语法：pid 参数 程序名称
 
用法示例：
# ps aux |grep mysql|grep -v root|awk '{print $2}'
9973
10096
[root@mysql-zhudan 3306]# pidof mysqld
10096 9973 
